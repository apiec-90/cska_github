{% extends "admin/change_form.html" %}
{% load i18n admin_urls %}

{% block extrahead %}
{{ block.super }}
<style>
  /* –û—Å–Ω–æ–≤–Ω—ã–µ —Å—Ç–∏–ª–∏ —Ñ–æ—Ä–º—ã */
  .schedule-form {
    background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
    border: 1px solid #dee2e6;
    border-radius: 8px;
    padding: 25px;
    margin: 20px 0;
    box-shadow: 0 4px 6px rgba(0,0,0,0.1);
    min-width: 400px;
    max-width: 100%;
  }
  
  .schedule-form h2 {
    margin: 0 0 20px 0;
    color: #495057;
    font-size: 20px;
    font-weight: 600;
  }
  
  /* –°—Ç–∏–ª–∏ –¥–ª—è —á–µ–∫–±–æ–∫—Å–æ–≤ –¥–Ω–µ–π –Ω–µ–¥–µ–ª–∏ */
  .weekday-checkbox-container {
    margin: 15px 0;
    padding: 15px;
    background: white;
    border-radius: 6px;
    border: 1px solid #e9ecef;
  }
  
  .weekday-item {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 8px 12px;
    margin: 4px 0;
    background: #f8f9fa;
    border-radius: 6px;
    border: 1px solid #e9ecef;
    transition: all 0.2s ease;
    height: 40px;
    box-sizing: border-box;
  }
  
  .weekday-item:hover {
    border-color: #007cba;
    background: #e7f3ff;
  }
  
  .weekday-text {
    font-weight: 500;
    font-size: 14px;
    color: #495057;
  }
  

  
  /* –°—Ç–∏–ª–∏ –¥–ª—è –¥–Ω–µ–π –Ω–µ–¥–µ–ª–∏ */
  .field-weekdays .form-row,
  .weekday-checkboxes {
    padding: 15px;
    background: #f8f9fa;
    border-radius: 8px;
    border: 1px solid #e9ecef;
    margin: 10px 0;
  }
  
  .field-weekdays .form-row label,
  .weekday-checkboxes label {
    font-weight: 600;
    color: #495057;
    margin-bottom: 15px;
    display: block;
  }
  
  .field-weekdays ul,
  .weekday-checkboxes {
    list-style: none;
    padding: 0;
    margin: 0;
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 8px;
  }
  
  .field-weekdays li,
  .weekday-checkboxes li {
    margin: 0;
    padding: 0;
  }
  
  .field-weekdays li label,
  .weekday-checkboxes li label {
    display: flex;
    align-items: center;
    gap: 8px;
    padding: 8px 12px;
    border-radius: 6px;
    background: white;
    border: 1px solid #dee2e6;
    cursor: pointer;
    transition: all 0.2s ease;
    font-weight: 500;
    color: #495057;
    margin: 0;
  }
  
  .field-weekdays li label:hover,
  .weekday-checkboxes li label:hover {
    background: #e3f2fd;
    border-color: #2196f3;
    color: #1976d2;
  }
  
  .field-weekdays input[type="checkbox"],
  .weekday-checkboxes input[type="checkbox"] {
    width: 18px;
    height: 18px;
    border: 2px solid #dee2e6;
    border-radius: 4px;
    background: white;
    position: relative;
    cursor: pointer;
    flex-shrink: 0;
    margin: 0;
  }
  
  .field-weekdays input[type="checkbox"]:checked,
  .weekday-checkboxes input[type="checkbox"]:checked {
    background: #2196f3;
    border-color: #2196f3;
  }
  
  .field-weekdays input[type="checkbox"]:checked + span,
  .weekday-checkboxes input[type="checkbox"]:checked + span {
    color: #1976d2;
    font-weight: 600;
  }
  
  .field-weekdays .helptext {
    color: #6c757d;
    font-size: 13px;
    margin-top: 8px;
    font-style: italic;
  }
  
  /* –°—Ç–∏–ª–∏ –¥–ª—è –≤—Ä–µ–º–µ–Ω–∏ */
  .time-inputs {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 20px;
    margin: 20px 0;
  }
  
  .time-input-group {
    background: white;
    padding: 15px;
    border-radius: 6px;
    border: 1px solid #e9ecef;
  }
  
  .time-input {
    width: 100%;
    padding: 8px 12px;
    border: 1px solid #ced4da;
    border-radius: 4px;
    font-size: 14px;
  }
  
  /* –ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å */
  @media (max-width: 768px) {
    .field-weekdays ul {
      grid-template-columns: 1fr;
    }
  }
  
  .time-input:focus {
    border-color: #007cba;
    outline: none;
    box-shadow: 0 0 0 2px rgba(0, 123, 186, 0.25);
  }
  
  @media (max-width: 768px) {
    .schedule-form {
      min-width: auto;
      padding: 20px;
    }
    
    .time-inputs {
      grid-template-columns: 1fr;
    }
  }
</style>
<script>
document.addEventListener('DOMContentLoaded', function() {
    console.log('üîç –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —á–µ–∫–±–æ–∫—Å–æ–≤ –¥–Ω–µ–π –Ω–µ–¥–µ–ª–∏...');
    
    // –ù–∞—Ö–æ–¥–∏–º —á–µ–∫–±–æ–∫—Å—ã –¥–Ω–µ–π –Ω–µ–¥–µ–ª–∏
    const weekdayCheckboxes = document.querySelectorAll('input[name*="weekdays"], .field-weekdays input[type="checkbox"], .weekday-checkboxes input[type="checkbox"]');
    console.log('–ù–∞–π–¥–µ–Ω–æ —á–µ–∫–±–æ–∫—Å–æ–≤:', weekdayCheckboxes.length);
    
    // –ï—Å–ª–∏ —á–µ–∫–±–æ–∫—Å—ã –Ω–µ –Ω–∞–π–¥–µ–Ω—ã, –ø–æ–ø—Ä–æ–±—É–µ–º –Ω–∞–π—Ç–∏ –≤—Å–µ —á–µ–∫–±–æ–∫—Å—ã
    if (weekdayCheckboxes.length === 0) {
        console.log('–ß–µ–∫–±–æ–∫—Å—ã –Ω–µ –Ω–∞–π–¥–µ–Ω—ã, –∏—â–µ–º –≤—Å–µ —á–µ–∫–±–æ–∫—Å—ã –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ...');
        const allCheckboxes = document.querySelectorAll('input[type="checkbox"]');
        console.log('–í—Å–µ–≥–æ —á–µ–∫–±–æ–∫—Å–æ–≤:', allCheckboxes.length);
        
        allCheckboxes.forEach((cb, index) => {
            console.log(`–ß–µ–∫–±–æ–∫—Å ${index}:`, cb.name, cb.id, cb.value);
        });
    }
    
    // –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º –∫–∞–∂–¥—ã–π —á–µ–∫–±–æ–∫—Å
    weekdayCheckboxes.forEach(function(checkbox) {
        console.log('–ù–∞—Å—Ç—Ä–æ–π–∫–∞ —á–µ–∫–±–æ–∫—Å–∞:', checkbox.name, checkbox.value);
        
        // –£–±–∏—Ä–∞–µ–º —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏, –µ—Å–ª–∏ –µ—Å—Ç—å
        checkbox.style.pointerEvents = 'auto';
        
        // –ü—Ä–æ—Å—Ç–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏—è
        checkbox.addEventListener('change', function() {
            console.log('–ß–µ–∫–±–æ–∫—Å –∏–∑–º–µ–Ω–µ–Ω:', this.value, this.checked);
            updateCheckboxStyle(this);
        });
        
        // –û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–ª–∏–∫–∞ (–¥–ª—è –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç–∏)
        checkbox.addEventListener('click', function(e) {
            console.log('–ö–ª–∏–∫ –ø–æ —á–µ–∫–±–æ–∫—Å—É:', this.value, this.checked);
            // –î–∞–µ–º –±—Ä–∞—É–∑–µ—Ä—É –æ–±—Ä–∞–±–æ—Ç–∞—Ç—å –∫–ª–∏–∫ –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω—ã–º –æ–±—Ä–∞–∑–æ–º
            setTimeout(() => updateCheckboxStyle(this), 5);
        });
        
        // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –Ω–∞—á–∞–ª—å–Ω—ã–π —Å—Ç–∏–ª—å
        updateCheckboxStyle(checkbox);
    });
    
    function updateCheckboxStyle(checkbox) {
        const label = checkbox.closest('label');
        const span = checkbox.nextElementSibling;
        
        if (checkbox.checked) {
            checkbox.style.backgroundColor = '#2196f3';
            checkbox.style.borderColor = '#2196f3';
            if (label) {
                label.style.backgroundColor = '#e3f2fd';
                label.style.borderColor = '#2196f3';
                label.style.color = '#1976d2';
            }
            if (span) {
                span.style.color = '#1976d2';
                span.style.fontWeight = '600';
            }
        } else {
            checkbox.style.backgroundColor = 'white';
            checkbox.style.borderColor = '#dee2e6';
            if (label) {
                label.style.backgroundColor = 'white';
                label.style.borderColor = '#dee2e6';
                label.style.color = '#495057';
            }
            if (span) {
                span.style.color = '#495057';
                span.style.fontWeight = '500';
            }
        }
    }
});
</script>
{% endblock %}

{% block content %}
<div class="schedule-form">
  <h2>üìÖ {{ original|yesno:"–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ,–°–æ–∑–¥–∞–Ω–∏–µ" }} —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è –≥—Ä—É–ø–ø—ã</h2>
  
  {{ block.super }}
</div>

<!-- JavaScript —É–¥–∞–ª–µ–Ω - –∏—Å–ø–æ–ª—å–∑—É–µ–º –∫–∞—Å—Ç–æ–º–Ω—ã–π –≤–∏–¥–∂–µ—Ç –≤–º–µ—Å—Ç–æ JS-–¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è -->
{% endblock %}