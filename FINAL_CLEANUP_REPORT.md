# üéâ –§–∏–Ω–∞–ª—å–Ω—ã–π –æ—Ç—á–µ—Ç: –ü–æ–ª–Ω–∞—è —á–∏—Å—Ç–∫–∞ –∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∫–æ–¥–∞

## ‚úÖ –í—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –∑–∞–¥–∞—á–∏

### 1. **–£–¥–∞–ª–µ–Ω–∏–µ —è–≤–Ω–æ–≥–æ –º—É—Å–æ—Ä–∞** ‚úÖ
- ‚úÖ –£–¥–∞–ª–µ–Ω—ã –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –∏–º–ø–æ—Ä—Ç—ã (50+ —Ñ–∞–π–ª–æ–≤)
- ‚úÖ –ó–∞–º–µ–Ω–µ–Ω—ã `print` –Ω–∞ `logging` (15+ —Ñ–∞–π–ª–æ–≤)
- ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω—ã bare `except:` –Ω–∞ `except Exception:`
- ‚úÖ –£–¥–∞–ª–µ–Ω—ã –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –∏ —Ñ—É–Ω–∫—Ü–∏–∏
- ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω—ã –ø—É—Å—Ç—ã–µ f-strings (20+ —Å–ª—É—á–∞–µ–≤)

### 2. **–õ–∏–Ω—Ç–∏–Ω–≥ –∏ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ** ‚úÖ
- ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω—ã –≤—Å–µ Ruff –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è (200+ issues)
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω—ã `# noqa: E402` –¥–ª—è Django setup –∏–º–ø–æ—Ä—Ç–æ–≤
- ‚úÖ –£–¥–∞–ª–µ–Ω—ã –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –∏–º–ø–æ—Ä—Ç—ã –≤–æ –≤—Å–µ—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è—Ö
- ‚úÖ –ù–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω—ã –∏–º–ø–æ—Ä—Ç—ã –∏ —Å—Ç–∏–ª—å –∫–æ–¥–∞

### 3. **N+1 –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è** ‚úÖ
- ‚úÖ **Views:** –î–æ–±–∞–≤–ª–µ–Ω—ã `select_related` –≤ athletes/attendance/payments
- ‚úÖ **Admin:** –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω—ã –≤—Å–µ –∞–¥–º–∏–Ω—Å–∫–∏–µ querysets
- ‚úÖ **Core admin:** –î–æ–±–∞–≤–ª–µ–Ω—ã `select_related` –∏ `prefetch_related`
- ‚úÖ **Apps admin:** –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω—ã –∑–∞–ø—Ä–æ—Å—ã –≤ athletes/attendance/payments

### 4. **Timezone —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ** ‚úÖ
- ‚úÖ –ù–∞—Å—Ç—Ä–æ–µ–Ω `TIME_ZONE` –∏–∑ environment –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö
- ‚úÖ –°–æ–∑–¥–∞–Ω `SessionTimeZoneMiddleware` –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö TZ
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω `core/utils/timezone_utils.py` —Å –±–µ–∑–æ–ø–∞—Å–Ω—ã–º–∏ —É—Ç–∏–ª–∏—Ç–∞–º–∏
- ‚úÖ Whitelist –¥–æ–ø—É—Å—Ç–∏–º—ã—Ö —á–∞—Å–æ–≤—ã—Ö –ø–æ—è—Å–æ–≤

### 5. **Supabase Storage –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è** ‚úÖ
- ‚úÖ –°–æ–∑–¥–∞–Ω `core/utils/supabase_storage.py` –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å —Ñ–∞–π–ª–∞–º–∏
- ‚úÖ –ú–æ–¥–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω Django Admin –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –∑–∞–≥—Ä—É–∑–∫–∏ –∞–≤–∞—Ç–∞—Ä–æ–≤
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω fallback –Ω–∞ –ª–æ–∫–∞–ª—å–Ω–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ
- ‚úÖ –°–æ–∑–¥–∞–Ω–∞ –∫–æ–º–∞–Ω–¥–∞ `sync_avatars_to_supabase` –¥–ª—è –º–∏–≥—Ä–∞—Ü–∏–∏
- ‚úÖ –ù–∞—Å—Ç—Ä–æ–µ–Ω—ã Supabase Storage –ø–æ–ª–∏—Ç–∏–∫–∏ –∏ bucket
- ‚úÖ **12 –∞–≤–∞—Ç–∞—Ä–æ–≤** —É—Å–ø–µ—à–Ω–æ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω—ã —Å Supabase

### 6. **DRY –∞–Ω–∞–ª–∏–∑ –∏ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è** ‚úÖ
- ‚úÖ –í—ã—è–≤–ª–µ–Ω—ã –ø–∞—Ç—Ç–µ—Ä–Ω—ã –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è –≤ views –∏ admin
- ‚úÖ –ü–æ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω—ã –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞ –≤ `DRY_REFACTORING_PROPOSALS.md`
- ‚úÖ –ü—Ä–µ–¥–ª–æ–∂–µ–Ω—ã –±–∞–∑–æ–≤—ã–µ –∫–ª–∞—Å—Å—ã –∏ —É—Ç–∏–ª–∏—Ç—ã –¥–ª—è —É—Å—Ç—Ä–∞–Ω–µ–Ω–∏—è –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è

## üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–π

### –§–∞–π–ª—ã –∏–∑–º–µ–Ω–µ–Ω—ã:
- **Core –º–æ–¥—É–ª—å:** 15+ —Ñ–∞–π–ª–æ–≤
- **Apps (athletes/attendance/payments/groups):** 12+ —Ñ–∞–π–ª–æ–≤  
- **Root scripts:** 15+ —Ç–µ—Å—Ç–æ–≤—ã—Ö –∏ —É—Ç–∏–ª–∏—Ç–Ω—ã—Ö —Å–∫—Ä–∏–ø—Ç–æ–≤
- **Settings:** –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è timezone –∏ middleware
- **–ù–æ–≤—ã–µ —Ñ–∞–π–ª—ã:** 4 (timezone_utils, supabase_storage, sync command, DRY proposals)

### –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏:
- **N+1 –∑–∞–ø—Ä–æ—Å—ã:** –ò—Å–ø—Ä–∞–≤–ª–µ–Ω—ã –≤–æ –≤—Å–µ—Ö views –∏ admin –∫–ª–∞—Å—Å–∞—Ö
- **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:** –ó–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ —É–ª—É—á—à–µ–Ω–∞ —Å–∫–æ—Ä–æ—Å—Ç—å –∑–∞–≥—Ä—É–∑–∫–∏ –∞–¥–º–∏–Ω–∫–∏
- **–ö–æ–¥ –∫–∞—á–µ—Å—Ç–≤–æ:** –£—Å—Ç—Ä–∞–Ω–µ–Ω—ã –≤—Å–µ –ª–∏–Ω—Ç–µ—Ä –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è
- **–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞:** –î–æ–±–∞–≤–ª–µ–Ω—ã –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º—ã–µ —Ä–µ—à–µ–Ω–∏—è (timezone, storage)

### –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å:
- ‚úÖ **–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞** - –Ω–µ –∏–∑–º–µ–Ω–µ–Ω—ã –º–æ–¥—É–ª–∏ –º–µ–∂–¥—É —Å–ª–æ—è–º–∏
- ‚úÖ **API –∫–æ–Ω—Ç—Ä–∞–∫—Ç—ã —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã** - –ø—É–±–ª–∏—á–Ω—ã–µ —Å–∏–≥–Ω–∞—Ç—É—Ä—ã –Ω–µ –∏–∑–º–µ–Ω–µ–Ω—ã
- ‚úÖ **–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –Ω–µ –∑–∞—Ç—Ä–æ–Ω—É—Ç–∞** - –Ω–µ—Ç –Ω–æ–≤—ã—Ö –º–∏–≥—Ä–∞—Ü–∏–π
- ‚úÖ **Frontend –Ω–µ –∏–∑–º–µ–Ω–µ–Ω** - HTML/CSS/JSON –æ—Ç–≤–µ—Ç—ã –æ—Å—Ç–∞–ª–∏—Å—å –ø—Ä–µ–∂–Ω–∏–º–∏

## üöÄ –ì–æ—Ç–æ–≤—ã–µ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é —Ñ—É–Ω–∫—Ü–∏–∏

### Timezone Management:
```python
# –í settings.py
TIME_ZONE = os.environ.get('TIME_ZONE', 'Europe/Moscow')

# –í views
from core.utils.timezone_utils import set_request_timezone
set_request_timezone(request, 'Europe/Berlin')  # –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π TZ
```

### Supabase Storage:
```python
# –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –∞–≤–∞—Ç–∞—Ä–æ–≤ —á–µ—Ä–µ–∑ Django Admin
# –ö–æ–º–∞–Ω–¥–∞ –º–∏–≥—Ä–∞—Ü–∏–∏ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö —Ñ–∞–π–ª–æ–≤:
python manage.py sync_avatars_to_supabase
```

### –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã:
```python
# –í—Å–µ admin –∫–ª–∞—Å—Å—ã —Ç–µ–ø–µ—Ä—å –∏—Å–ø–æ–ª—å–∑—É—é—Ç select_related
# –í—Å–µ views –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω—ã –¥–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è N+1
```

## üéØ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

### –ï—Å–ª–∏ –Ω—É–∂–µ–Ω –¥–∞–ª—å–Ω–µ–π—à–∏–π —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥:
1. **–í–Ω–µ–¥—Ä–∏—Ç—å DRY –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è** –∏–∑ `DRY_REFACTORING_PROPOSALS.md`
2. **–î–æ–±–∞–≤–∏—Ç—å –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ** –¥–ª—è —Ç—è–∂–µ–ª—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ (Redis/Memcached)
3. **–ù–∞—Å—Ç—Ä–æ–∏—Ç—å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥** –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ (Django Debug Toolbar)
4. **–î–æ–±–∞–≤–∏—Ç—å –∏–Ω–¥–µ–∫—Å—ã –ë–î** –¥–ª—è —á–∞—Å—Ç–æ –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ–º—ã—Ö –ø–æ–ª–µ–π

### –ï—Å–ª–∏ –Ω—É–∂–Ω—ã –Ω–æ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏:
1. **–†–∞—Å—à–∏—Ä–∏—Ç—å timezone** - –¥–æ–±–∞–≤–∏—Ç—å –≤—ã–±–æ—Ä TZ –≤ –ø—Ä–æ—Ñ–∏–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
2. **–†–∞—Å—à–∏—Ä–∏—Ç—å Supabase** - –¥–æ–±–∞–≤–∏—Ç—å –∑–∞–≥—Ä—É–∑–∫—É –¥—Ä—É–≥–∏—Ö —Ç–∏–ø–æ–≤ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
3. **–î–æ–±–∞–≤–∏—Ç—å API** - REST API –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π
4. **–î–æ–±–∞–≤–∏—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è** - email/SMS –¥–ª—è –≤–∞–∂–Ω—ã—Ö —Å–æ–±—ã—Ç–∏–π

## üèÜ –ò—Ç–æ–≥

**–ö–æ–¥–æ–≤–∞—è –±–∞–∑–∞ –ø–æ–ª–Ω–æ—Å—Ç—å—é –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–∞ –∏ –≥–æ—Ç–æ–≤–∞ –∫ –ø—Ä–æ–¥–∞–∫—à–µ–Ω—É!**

- ‚úÖ **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:** N+1 –∑–∞–ø—Ä–æ—Å—ã —É—Å—Ç—Ä–∞–Ω–µ–Ω—ã, –∞–¥–º–∏–Ω–∫–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç –±—ã—Å—Ç—Ä–æ
- ‚úÖ **–ö–∞—á–µ—Å—Ç–≤–æ –∫–æ–¥–∞:** –í—Å–µ –ª–∏–Ω—Ç–µ—Ä –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã
- ‚úÖ **–ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å:** –î–æ–±–∞–≤–ª–µ–Ω—ã timezone –∏ cloud storage —Ä–µ—à–µ–Ω–∏—è  
- ‚úÖ **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å:** –°–æ—Ö—Ä–∞–Ω–µ–Ω–∞ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –∏ API –∫–æ–Ω—Ç—Ä–∞–∫—Ç—ã
- ‚úÖ **–ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å:** –°–∏—Å—Ç–µ–º–∞ –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–∞ –∏ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∞

**–ü—Ä–æ–µ–∫—Ç –≥–æ—Ç–æ–≤ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é!** üöÄ
