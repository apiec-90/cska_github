{% extends "admin/change_form.html" %}
{% load i18n admin_urls static admin_modify %}

{% block extrahead %}
{{ block.super }}
<style>
    .schedule-info {
        background: #f9f9f9;
        border: 1px solid #ddd;
        border-radius: 4px;
        padding: 15px;
        margin: 10px 0;
    }
    .schedule-item {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 8px 0;
        border-bottom: 1px solid #eee;
    }
    .schedule-item:last-child {
        border-bottom: none;
    }
    .weekday-name {
        font-weight: bold;
        color: #333;
    }
    .time-info {
        color: #666;
    }
    .sessions-summary {
        background: #e8f4fd;
        border: 1px solid #b3d9ff;
        border-radius: 4px;
        padding: 15px;
        margin: 10px 0;
    }
    .stats-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 15px;
        margin-top: 10px;
    }
    .stat-item {
        text-align: center;
        padding: 10px;
        background: white;
        border-radius: 4px;
        border: 1px solid #ddd;
    }
    .stat-number {
        font-size: 24px;
        font-weight: bold;
        color: #007cba;
    }
    .stat-label {
        color: #666;
        font-size: 12px;
        text-transform: uppercase;
    }
</style>
{% endblock %}

{% block field_sets %}
    {{ block.super }}
    
    {% if original %}
    <div class="schedule-info">
        <h3>üìÖ –†–∞—Å–ø–∏—Å–∞–Ω–∏–µ –≥—Ä—É–ø–ø—ã</h3>
        {% if original.groupschedule_set.all %}
            {% for schedule in original.groupschedule_set.all %}
            <div class="schedule-item">
                <span class="weekday-name">
                    {% if schedule.weekday == 1 %}–ü–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫
                    {% elif schedule.weekday == 2 %}–í—Ç–æ—Ä–Ω–∏–∫
                    {% elif schedule.weekday == 3 %}–°—Ä–µ–¥–∞
                    {% elif schedule.weekday == 4 %}–ß–µ—Ç–≤–µ—Ä–≥
                    {% elif schedule.weekday == 5 %}–ü—è—Ç–Ω–∏—Ü–∞
                    {% elif schedule.weekday == 6 %}–°—É–±–±–æ—Ç–∞
                    {% elif schedule.weekday == 7 %}–í–æ—Å–∫—Ä–µ—Å–µ–Ω—å–µ
                    {% endif %}
                </span>
                <span class="time-info">{{ schedule.start_time|time:"H:i" }} - {{ schedule.end_time|time:"H:i" }}</span>
            </div>
            {% endfor %}
        {% else %}
            <p style="color: #999; font-style: italic;">–†–∞—Å–ø–∏—Å–∞–Ω–∏–µ –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–æ</p>
        {% endif %}
    </div>

    <div class="sessions-summary">
        <h3>üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –≥—Ä—É–ø–ø—ã</h3>
        <div class="stats-grid">
            <div class="stat-item">
                <div class="stat-number">{{ original.attendancerecord_set.count }}</div>
                <div class="stat-label">–í—Å–µ–≥–æ –∑–∞–ø–∏—Å–µ–π</div>
            </div>
            <div class="stat-item">
                <div class="stat-number">{{ original.athletetraininggroup_set.count }}</div>
                <div class="stat-label">–°–ø–æ—Ä—Ç—Å–º–µ–Ω–æ–≤</div>
            </div>
            <div class="stat-item">
                <div class="stat-number">{{ original.groupschedule_set.count }}</div>
                <div class="stat-label">–†–∞—Å–ø–∏—Å–∞–Ω–∏–π</div>
            </div>
        </div>
        
        <div style="margin-top: 15px;">
            <a href="{% url 'admin:core_attendancerecord_changelist' %}?training_group__id__exact={{ original.id }}" 
               class="button" style="background: #007cba; color: white; padding: 8px 16px; text-decoration: none; border-radius: 4px;">
                üìù –ñ—É—Ä–Ω–∞–ª –ø–æ—Å–µ—â–∞–µ–º–æ—Å—Ç–∏
            </a>
        </div>
    </div>
    {% endif %}
{% endblock %}
