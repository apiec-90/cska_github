{% extends "admin/base_site.html" %}
{% load custom_filters %}

{% block extrastyle %}
<style>
/* –û—Å–Ω–æ–≤–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ */
:root {
  --primary-color: #4CAF50;
  --secondary-color: #2196F3;
  --danger-color: #f44336;
  --warning-color: #ff9800;
  --success-color: #4CAF50;
  --light-bg: #f8f9fa;
  --border-color: #dee2e6;
  --shadow: 0 2px 8px rgba(0,0,0,0.1);
  --transition: all 0.3s ease;
}

/* –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –∂—É—Ä–Ω–∞–ª–∞ */
.journal-container {
  background: white;
  border-radius: 12px;
  box-shadow: var(--shadow);
  overflow: hidden;
  margin: 20px 0;
}

/* –ó–∞–≥–æ–ª–æ–≤–æ–∫ */
.journal-header {
  background: linear-gradient(135deg, var(--primary-color), #45a049);
  color: white;
  padding: 20px 30px;
  display: flex;
  justify-content: space-between;
  align-items: center;
}

.journal-title {
  margin: 0;
  font-size: 24px;
  font-weight: 600;
}

.journal-subtitle {
  margin: 5px 0 0 0;
  opacity: 0.9;
  font-size: 14px;
}

/* –ü–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è */
.control-panel {
  padding: 20px 30px;
  background: var(--light-bg);
  border-bottom: 1px solid var(--border-color);
  display: flex;
  justify-content: space-between;
  align-items: center;
  flex-wrap: wrap;
  gap: 15px;
}

.control-info {
  display: flex;
  align-items: center;
  gap: 20px;
}

.changes-counter {
  background: var(--secondary-color);
  color: white;
  padding: 8px 16px;
  border-radius: 20px;
  font-weight: 600;
  font-size: 14px;
  transition: var(--transition);
}

.changes-counter.has-changes {
  background: var(--warning-color);
  animation: pulse 2s infinite;
}

@keyframes pulse {
  0% { transform: scale(1); }
  50% { transform: scale(1.05); }
  100% { transform: scale(1); }
}

.save-button {
  background: var(--success-color);
  color: white;
  border: none;
  padding: 12px 24px;
  border-radius: 8px;
  cursor: pointer;
  font-weight: 600;
  font-size: 14px;
  transition: var(--transition);
  display: flex;
  align-items: center;
  gap: 8px;
}

.save-button:hover {
  background: #45a049;
  transform: translateY(-2px);
  box-shadow: 0 4px 12px rgba(76, 175, 80, 0.3);
}

.save-button:disabled {
  background: #ccc;
  cursor: not-allowed;
  transform: none;
  box-shadow: none;
}

/* –¢–∞–±–ª–∏—Ü–∞ */
.attendance-table-wrapper {
  overflow-x: auto;
  max-height: 70vh;
  position: relative;
}

.attendance-table {
  width: 100%;
  border-collapse: collapse;
  font-size: 14px;
  background: white;
}

.attendance-table thead {
  position: sticky;
  top: 0;
  z-index: 10;
}

.attendance-table th {
  background: var(--light-bg);
  border: 1px solid var(--border-color);
  padding: 12px 8px;
  text-align: center;
  font-weight: 600;
  color: #495057;
  white-space: nowrap;
}

.attendance-table th.athlete-name {
  text-align: left;
  min-width: 180px;
  position: sticky;
  left: 0;
  background: var(--light-bg);
  z-index: 11;
  box-shadow: 2px 0 5px rgba(0,0,0,0.1);
}

.attendance-table td {
  border: 1px solid var(--border-color);
  padding: 0;
  text-align: center;
  position: relative;
}

.attendance-table td.athlete-name {
  padding: 12px 16px;
  text-align: left;
  font-weight: 600;
  background: white;
  position: sticky;
  left: 0;
  z-index: 9;
  box-shadow: 2px 0 5px rgba(0,0,0,0.1);
}

/* –ß–µ–∫–±–æ–∫—Å—ã –¥–ª—è –æ—Ç–º–µ—Ç–æ–∫ */
.attendance-checkbox-wrapper {
  display: flex;
  justify-content: center;
  align-items: center;
  width: 100%;
  height: 50px;
  cursor: pointer;
  transition: var(--transition);
  position: relative;
}

.attendance-checkbox-wrapper:hover {
  background: rgba(76, 175, 80, 0.1);
}

.attendance-checkbox {
  appearance: none;
  width: 24px;
  height: 24px;
  border: 2px solid #ddd;
  border-radius: 6px;
  cursor: pointer;
  transition: var(--transition);
  position: relative;
  background: white;
}

.attendance-checkbox:checked {
  background: var(--primary-color);
  border-color: var(--primary-color);
}

.attendance-checkbox:checked::after {
  content: '‚úì';
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  color: white;
  font-weight: bold;
  font-size: 16px;
}

.attendance-checkbox:hover {
  border-color: var(--primary-color);
  box-shadow: 0 0 0 3px rgba(76, 175, 80, 0.2);
}

/* –°—Ç–∞—Ç—É—Å—ã —è—á–µ–µ–∫ */
.session-cell {
  position: relative;
}

.session-cell.today {
  background: rgba(33, 150, 243, 0.05);
}

.session-cell.past {
  background: rgba(108, 117, 125, 0.05);
}

.session-cell.future {
  background: rgba(255, 193, 7, 0.05);
}

.session-cell.closed {
  background: rgba(220, 53, 69, 0.05);
  pointer-events: none;
}

.session-cell.closed .attendance-checkbox {
  opacity: 0.5;
  cursor: not-allowed;
}

/* –ó–∞–≥–æ–ª–æ–≤–∫–∏ —Å–µ—Å—Å–∏–π */
.session-header {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 4px;
  min-width: 60px;
}

.session-date {
  font-weight: 600;
  color: #495057;
}

.session-time {
  font-size: 11px;
  color: #6c757d;
}

.session-status {
  font-size: 10px;
  padding: 2px 6px;
  border-radius: 10px;
  font-weight: 500;
}

.session-status.today {
  background: var(--secondary-color);
  color: white;
}

.session-status.past {
  background: #6c757d;
  color: white;
}

.session-status.future {
  background: var(--warning-color);
  color: white;
}

.session-status.closed {
  background: var(--danger-color);
  color: white;
}

/* –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è */
.notification {
  position: fixed;
  top: 20px;
  right: 20px;
  padding: 16px 24px;
  border-radius: 8px;
  color: white;
  font-weight: 600;
  z-index: 1000;
  transform: translateX(400px);
  transition: var(--transition);
  display: flex;
  align-items: center;
  gap: 10px;
  box-shadow: var(--shadow);
}

.notification.show {
  transform: translateX(0);
}

.notification.success {
  background: var(--success-color);
}

.notification.error {
  background: var(--danger-color);
}

.notification.warning {
  background: var(--warning-color);
}

/* –ó–∞–≥—Ä—É–∑—á–∏–∫ */
.loading-overlay {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: rgba(0,0,0,0.5);
  display: flex;
  justify-content: center;
  align-items: center;
  z-index: 2000;
  opacity: 0;
  visibility: hidden;
  transition: var(--transition);
}

.loading-overlay.show {
  opacity: 1;
  visibility: visible;
}

.spinner {
  width: 50px;
  height: 50px;
  border: 4px solid rgba(255,255,255,0.3);
  border-top: 4px solid white;
  border-radius: 50%;
  animation: spin 1s linear infinite;
}

@keyframes spin {
  0% { transform: rotate(0deg); }
  100% { transform: rotate(360deg); }
}

/* –ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å */
@media (max-width: 768px) {
  .journal-header {
    padding: 15px 20px;
  }
  
  .journal-title {
    font-size: 20px;
  }
  
  .control-panel {
    padding: 15px 20px;
    flex-direction: column;
    align-items: stretch;
  }
  
  .control-info {
    justify-content: center;
  }
  
  .attendance-table th.athlete-name {
    min-width: 120px;
  }
  
  .session-header {
    min-width: 50px;
  }
}
</style>
{% endblock %}

{% block content %}
{% csrf_token %}

<div class="journal-container">
  <!-- –ó–∞–≥–æ–ª–æ–≤–æ–∫ -->
  <div class="journal-header">
    <div>
      <h1 class="journal-title">üìã {{ title }}</h1>
      <p class="journal-subtitle">–ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π –∂—É—Ä–Ω–∞–ª –ø–æ—Å–µ—â–∞–µ–º–æ—Å—Ç–∏</p>
    </div>
    <div>
      <a href="{% url 'admin:core_traininggroup_panel' group.pk %}" 
         style="color: white; text-decoration: none; padding: 8px 16px; background: rgba(255,255,255,0.2); border-radius: 6px;">
        ‚Üê –ù–∞–∑–∞–¥ –∫ –≥—Ä—É–ø–ø–µ
      </a>
    </div>
  </div>

  <!-- –ü–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è -->
  <div class="control-panel">
    <div class="control-info">
      <div class="changes-counter" id="changes-counter">
        –ò–∑–º–µ–Ω–µ–Ω–∏–π: 0
      </div>
      <div style="font-size: 13px; color: #6c757d;">
        üí° –ö–ª–∏–∫–Ω–∏—Ç–µ –ø–æ —á–µ–∫–±–æ–∫—Å–∞–º –¥–ª—è –æ—Ç–º–µ—Ç–∫–∏ –ø—Ä–∏—Å—É—Ç—Å—Ç–≤–∏—è
      </div>
    </div>
    <button class="save-button" id="save-button" onclick="AttendanceApp.saveChanges()" disabled>
      üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è
    </button>
  </div>

  <!-- –¢–∞–±–ª–∏—Ü–∞ –ø–æ—Å–µ—â–∞–µ–º–æ—Å—Ç–∏ -->
  <div class="attendance-table-wrapper">
    <table class="attendance-table" id="attendance-table">
      <thead>
        <tr>
          <th class="athlete-name">üë§ –°–ø–æ—Ä—Ç—Å–º–µ–Ω</th>
          {% for session in sessions %}
          <th class="session-cell {% if session.date == today %}today{% elif session.date < today %}past{% else %}future{% endif %}{% if session.is_closed %} closed{% endif %}">
            <div class="session-header">
              <div class="session-date">{{ session.date|date:"d.m" }}</div>
              <div class="session-time">{{ session.start_time|time:"H:i" }}</div>
              <div class="session-status {% if session.date == today %}today{% elif session.date < today %}past{% else %}future{% endif %}{% if session.is_closed %} closed{% endif %}">
                {% if session.is_closed %}
                  –ó–∞–∫—Ä—ã—Ç–∞
                {% elif session.date == today %}
                  –°–µ–≥–æ–¥–Ω—è
                {% elif session.date < today %}
                  –ü—Ä–æ—à–ª–∞
                {% else %}
                  –ë—É–¥—É—â–∞—è
                {% endif %}
              </div>
            </div>
          </th>
          {% endfor %}
        </tr>
      </thead>
      <tbody>
        {% for athlete in children %}
        <tr>
          <td class="athlete-name">
            {{ athlete.last_name }} {{ athlete.first_name }}
          </td>
          {% for session in sessions %}
          {% with session_present=present|lookup:session.id %}
          <td class="session-cell {% if session.date == today %}today{% elif session.date < today %}past{% else %}future{% endif %}{% if session.is_closed %} closed{% endif %}">
            <div class="attendance-checkbox-wrapper" 
                 onclick="AttendanceApp.toggleAttendance({{ session.id }}, {{ athlete.id }}, this)">
              <input type="checkbox" 
                     class="attendance-checkbox"
                     data-session="{{ session.id }}"
                     data-athlete="{{ athlete.id }}"
                     {% if session_present and athlete.id in session_present %}checked{% endif %}
                     {% if session.is_closed or session.date > today %}disabled{% endif %}>
            </div>
          </td>
          {% endwith %}
          {% endfor %}
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
</div>

<!-- –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è -->
<div id="notification" class="notification"></div>

<!-- –ó–∞–≥—Ä—É–∑—á–∏–∫ -->
<div id="loading-overlay" class="loading-overlay">
  <div class="spinner"></div>
</div>

<script>
// Context API –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º –∂—É—Ä–Ω–∞–ª–∞ –ø–æ—Å–µ—â–∞–µ–º–æ—Å—Ç–∏
class AttendanceContext {
  constructor() {
    this.state = {
      changes: new Map(),
      isLoading: false,
      notifications: []
    };
    this.subscribers = [];
  }

  // –ü–æ–¥–ø–∏—Å–∫–∞ –Ω–∞ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏—è
  subscribe(callback) {
    this.subscribers.push(callback);
    return () => {
      this.subscribers = this.subscribers.filter(sub => sub !== callback);
    };
  }

  // –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –ø–æ–¥–ø–∏—Å—á–∏–∫–æ–≤ –æ–± –∏–∑–º–µ–Ω–µ–Ω–∏—è—Ö
  notify() {
    this.subscribers.forEach(callback => callback(this.state));
  }

  // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è
  setState(updates) {
    this.state = { ...this.state, ...updates };
    this.notify();
  }

  // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –ø–æ—Å–µ—â–∞–µ–º–æ—Å—Ç–∏
  addChange(sessionId, athleteId, isPresent) {
    const key = `${sessionId}_${athleteId}`;
    const newChanges = new Map(this.state.changes);
    
    newChanges.set(key, {
      session_id: parseInt(sessionId),
      athlete_id: parseInt(athleteId),
      present: isPresent
    });
    
    this.setState({ changes: newChanges });
  }

  // –û—á–∏—Å—Ç–∫–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–π
  clearChanges() {
    this.setState({ changes: new Map() });
  }

  // –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è –∑–∞–≥—Ä—É–∑–∫–∏
  setLoading(isLoading) {
    this.setState({ isLoading });
  }

  // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
  addNotification(message, type = 'info') {
    const notification = {
      id: Date.now(),
      message,
      type,
      timestamp: new Date()
    };
    
    const notifications = [...this.state.notifications, notification];
    this.setState({ notifications });
    
    // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ —á–µ—Ä–µ–∑ 5 —Å–µ–∫—É–Ω–¥
    setTimeout(() => {
      this.removeNotification(notification.id);
    }, 5000);
    
    return notification.id;
  }

  // –£–¥–∞–ª–µ–Ω–∏–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
  removeNotification(id) {
    const notifications = this.state.notifications.filter(n => n.id !== id);
    this.setState({ notifications });
  }
}

// –û—Å–Ω–æ–≤–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∂—É—Ä–Ω–∞–ª–æ–º –ø–æ—Å–µ—â–∞–µ–º–æ—Å—Ç–∏
class AttendanceApp {
  constructor() {
    this.context = new AttendanceContext();
    this.elements = {
      changesCounter: document.getElementById('changes-counter'),
      saveButton: document.getElementById('save-button'),
      notification: document.getElementById('notification'),
      loadingOverlay: document.getElementById('loading-overlay'),
      table: document.getElementById('attendance-table')
    };
    
    this.init();
  }

  init() {
    // –ü–æ–¥–ø–∏—Å–∫–∞ –Ω–∞ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏—è
    this.context.subscribe((state) => {
      this.updateUI(state);
    });

    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è UI
    this.updateUI(this.context.state);
    
    console.log('üìã –ñ—É—Ä–Ω–∞–ª –ø–æ—Å–µ—â–∞–µ–º–æ—Å—Ç–∏ –∑–∞–≥—Ä—É–∂–µ–Ω');
    console.log(`üìä –ù–∞–π–¥–µ–Ω–æ ${document.querySelectorAll('.attendance-checkbox').length} —á–µ–∫–±–æ–∫—Å–æ–≤`);
  }

  // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è
  updateUI(state) {
    // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—á–µ—Ç—á–∏–∫–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–π
    const changesCount = state.changes.size;
    this.elements.changesCounter.textContent = `–ò–∑–º–µ–Ω–µ–Ω–∏–π: ${changesCount}`;
    
    if (changesCount > 0) {
      this.elements.changesCounter.classList.add('has-changes');
      this.elements.saveButton.disabled = false;
      this.elements.saveButton.textContent = `üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å ${changesCount} –∏–∑–º–µ–Ω–µ–Ω–∏–π`;
    } else {
      this.elements.changesCounter.classList.remove('has-changes');
      this.elements.saveButton.disabled = true;
      this.elements.saveButton.textContent = 'üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è';
    }

    // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è –∑–∞–≥—Ä—É–∑–∫–∏
    if (state.isLoading) {
      this.elements.loadingOverlay.classList.add('show');
    } else {
      this.elements.loadingOverlay.classList.remove('show');
    }

    // –ü–æ–∫–∞–∑ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
    state.notifications.forEach(notification => {
      if (!notification.shown) {
        this.showNotification(notification.message, notification.type);
        notification.shown = true;
      }
    });
  }

  // –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –æ—Ç–º–µ—Ç–∫–∏ –ø–æ—Å–µ—â–∞–µ–º–æ—Å—Ç–∏
  toggleAttendance(sessionId, athleteId, element) {
    const checkbox = element.querySelector('.attendance-checkbox');
    
    // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –Ω–µ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–∞ –ª–∏ —è—á–µ–π–∫–∞
    if (checkbox.disabled) {
      this.showNotification('–≠—Ç–∞ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞ –∑–∞–∫—Ä—ã—Ç–∞ –¥–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è', 'warning');
      return;
    }

    // –ü–µ—Ä–µ–∫–ª—é—á–∞–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ —á–µ–∫–±–æ–∫—Å–∞
    const newState = !checkbox.checked;
    checkbox.checked = newState;

    // –î–æ–±–∞–≤–ª—è–µ–º –∏–∑–º–µ–Ω–µ–Ω–∏–µ –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç
    this.context.addChange(sessionId, athleteId, newState);

    // –í–∏–∑—É–∞–ª—å–Ω–∞—è –æ–±—Ä–∞—Ç–Ω–∞—è —Å–≤—è–∑—å
    element.style.transform = 'scale(0.95)';
    setTimeout(() => {
      element.style.transform = 'scale(1)';
    }, 150);

    console.log(`üìù –û—Ç–º–µ—Ç–∫–∞ –∏–∑–º–µ–Ω–µ–Ω–∞: —Å–ø–æ—Ä—Ç—Å–º–µ–Ω ${athleteId}, —Å–µ—Å—Å–∏—è ${sessionId}, –ø—Ä–∏—Å—É—Ç—Å—Ç–≤–∏–µ: ${newState}`);
  }

  // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π
  async saveChanges() {
    const changes = Array.from(this.context.state.changes.values());
    
    if (changes.length === 0) {
      this.showNotification('–ù–µ—Ç –∏–∑–º–µ–Ω–µ–Ω–∏–π –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è', 'warning');
      return;
    }

    this.context.setLoading(true);

    try {
      const formData = new FormData();
      formData.append('csrfmiddlewaretoken', document.querySelector('[name=csrfmiddlewaretoken]').value);
      formData.append('action', 'bulk_update_attendance');
      formData.append('changes', JSON.stringify(changes));

      console.log('üíæ –û—Ç–ø—Ä–∞–≤–∫–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–π:', changes);

      const response = await fetch(window.location.href, {
        method: 'POST',
        body: formData
      });

      const data = await response.json();

      if (data.success) {
        this.context.clearChanges();
        this.showNotification(`‚úÖ –£—Å–ø–µ—à–Ω–æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–æ ${data.updated_count} –∑–∞–ø–∏—Å–µ–π`, 'success');
        console.log('‚úÖ –ò–∑–º–µ–Ω–µ–Ω–∏—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã —É—Å–ø–µ—à–Ω–æ');
      } else {
        this.showNotification(`‚ùå –û—à–∏–±–∫–∞: ${data.error}`, 'error');
        console.error('‚ùå –û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è:', data.error);
      }
    } catch (error) {
      this.showNotification('‚ùå –û—à–∏–±–∫–∞ —Å–µ—Ç–∏ –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏', 'error');
      console.error('‚ùå –û—à–∏–±–∫–∞ —Å–µ—Ç–∏:', error);
    } finally {
      this.context.setLoading(false);
    }
  }

  // –ü–æ–∫–∞–∑ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
  showNotification(message, type = 'info') {
    const notification = this.elements.notification;
    
    notification.textContent = message;
    notification.className = `notification ${type}`;
    notification.classList.add('show');

    setTimeout(() => {
      notification.classList.remove('show');
    }, 4000);
  }
}

// –ì–ª–æ–±–∞–ª—å–Ω—ã–π —ç–∫–∑–µ–º–ø–ª—è—Ä –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
window.AttendanceApp = null;

// –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ DOM
document.addEventListener('DOMContentLoaded', function() {
  window.AttendanceApp = new AttendanceApp();
});
</script>

{% endblock %}
